package soc.storm.situation.utils;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.Arrays;
import java.util.Map;
import java.util.UUID;

public class FieldsGenerateUtil {

    public static void main(String[] args) throws IOException {
        String path = "E:\\项目文档\\大连流量数据接入\\金睛数据示例\\告警\\ziduan.txt";
        FileReader fr = new FileReader(path);
        BufferedReader br = new BufferedReader(fr);
        StringBuilder sb = new StringBuilder();
        String str = null;
        while ((str = br.readLine()) != null){
            str = str.split("\\^")[0];
            sb.append(str);
            sb.append(",");
        }

        System.out.println(sb);
        String[] sbArray = sb.toString().substring(0,sb.length()-1).split(",");

        System.out.println("sbArrays length: " + sbArray.length);

        String fieldsJson = "{\"protocol\":{\"type\":\"string\"},\"referer\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"agent\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"rsp_body_len\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"serial_num\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"rsp_content_type\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"parameter\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"method\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"req_body\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"req_header\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"host\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"cookie\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"uri\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"rsp_content_length\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"rsp_body\":{\"type\":\"string\"},\"rsp_header\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"detail_info\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"confidence\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"vuln_harm\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"vuln_name\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"vuln_type\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"file\":{\"type\":\"string\"},\"file_md5\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"system_id\":{\"doc_values\":true,\"type\":\"integer\"},\"event_type\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"event_subtype\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"event_level\":{\"type\":\"integer\",\"doc_values\":true},\"dcounty\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"solution\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"geo_sip\":{\"properties\":{\"subdivision\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"latitude\":{\"type\":\"float\"},\"longitude\":{\"type\":\"float\"},\"country_code2\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"continent_code\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"city_name\":{\"index\":\"not_analyzed\",\"type\":\"string\"}}},\"sport\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"attack_type\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"sip\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"threat_level\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"event_id\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"industry_id\":{\"doc_values\":true,\"type\":\"integer\"},\"found_time\":{\"doc_values\":true,\"type\":\"date\",\"format\":\"dateOptionalTime\"},\"vendor\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"description\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"data_type\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"event_token\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"organization_id\":{\"doc_values\":true,\"type\":\"integer\"},\"rule_num\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"dcity\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"user\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"geo_dip\":{\"properties\":{\"subdivision\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"latitude\":{\"type\":\"float\"},\"longitude\":{\"type\":\"float\"},\"country_code2\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"continent_code\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"city_name\":{\"index\":\"not_analyzed\",\"type\":\"string\"}}},\"back_up\":{\"type\":\"object\"},\"d_location\":{\"doc_values\":true,\"type\":\"geo_point\"},\"bugtraq\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"dprovince\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"dport\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"cve\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"dip\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"industry_name\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"organization_name\":{\"index\":\"not_analyzed\",\"type\":\"string\",\"doc_values\":true},\"webrules_tag\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"public_date\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"code_language\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"site_app\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"attack_result\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"vendor_id\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"device_ip\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"rule_name\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"rule_version\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"cnnvd_id\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"origin_record\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"origin_type\":{\"type\":\"string\",\"index\":\"not_analyzed\",\"doc_values\":true},\"dst_ip_country\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_user_agent\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sub_category\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"family\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby14\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"severity\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sensor_ip\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_ip_country_code\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_dst_mac\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_service\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dns_answers\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"reliability\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dns_query\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"smtp_smtp_to\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_orig_pkts\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"rid\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"app_proto\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_md5\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"payload\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"category\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_duration\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"event_source\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"uuid\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"proto\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_version\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sensor_name\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_ip_country_code\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sumstat_duration\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby5\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby4\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby7\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby6\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_ip_geoloc\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby3\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby2\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"ftp_ftp_cmd\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby1\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"desc\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby9\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby8\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_uri\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"situation_user\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_ip_city\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_resp_pkts\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_ssdeep\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"timestamp\":{\"type\":\"date\",\"format\":\"dateOptionalTime||epoch_millis\"},\"src_port\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_sha256\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"kill_chain\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_service\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_ip_country\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_host\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sumstat_sample\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_content_length\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_orig_bytes\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"interface\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_resp_bytes\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_method\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"smtp_smtp_from\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_src_mac\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_ip_geoloc\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_tag\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"standby13\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"sumstat_number\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"resp_data\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"target\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"situation_thread_id\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_content_type\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"message\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_referrer\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"conn_conn_state\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"http_status_code\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_ip_city\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_filename\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dns_qtype_name\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"file_package\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_port\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"classtype\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dst_ip\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"src_ip\":{\"index\":\"not_analyzed\",\"type\":\"string\"},\"dns_ttl\":{\"index\":\"not_analyzed\",\"type\":\"string\"}}";
        Map<String, Object> fieldsMap = JsonUtils.jsonToMap(fieldsJson);
        String result = "";
        int i = 0;
        int j = 0;
        for(Map.Entry<String, Object> entry : fieldsMap.entrySet()){
            i++;
            String s = entry.getKey();
            if(!Arrays.asList(sbArray).contains(s)) {
                j++;
//                System.out.println(s);
//                System.out.println(j);
                result = result + s;
                result = result + ",";
            }
        }
        System.out.println("i = " + i);
        System.out.println("j = " + j);
        System.out.println(result);

        System.out.println(  UUID.randomUUID().toString().replaceAll("-", ""));
    }
}
